
> deepagents@1.6.3 test
> vitest run

[33mTesting types with tsc and vue-tsc is an experimental feature.
Breaking changes might not follow SemVer, please pin Vitest's version when using it.[39m

[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/app/libs/deepagents[39m

 [32mâœ“[39m src/backends/biome.test.ts [2m([22m[2m2 tests[22m[2m)[22m[33m 519[2mms[22m[39m
     [33m[2mâœ“[22m[39m should format a JS file in the virtual filesystem [33m 372[2mms[22m[39m
 [32mâœ“[39m src/backends/esbuild.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 706[2mms[22m[39m
     [33m[2mâœ“[22m[39m should bundle a simple TS file in the virtual filesystem [33m 704[2mms[22m[39m
[90mstderr[2m | src/middleware/skills.test.ts[2m > [22m[2mcreateSkillsMiddleware[2m > [22m[2mbeforeAgent[2m > [22m[2mshould skip skills with invalid frontmatter
[22m[39mSkipping /skills/user/invalid/SKILL.md: no valid YAML frontmatter found

 [32mâœ“[39m src/middleware/skills.test.ts [2m([22m[2m33 tests[22m[2m)[22m[33m 642[2mms[22m[39m
 [32mâœ“[39m src/backends/composite.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 341[2mms[22m[39m
 [32mâœ“[39m src/middleware/memory.test.ts [2m([22m[2m16 tests[22m[2m)[22m[33m 498[2mms[22m[39m
 [32mâœ“[39m src/backends/filesystem.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 179[2mms[22m[39m
[90mstderr[2m | src/skills/loader.test.ts[2m > [22m[2mSkill Loader Module[2m > [22m[2mparseSkillMetadata[2m > [22m[2mshould return null for missing frontmatter
[22m[39mSkipping /tmp/deepagents-skills-test-XLDhMl/user-skills/no-frontmatter/SKILL.md: no valid YAML frontmatter found

[90mstderr[2m | src/skills/loader.test.ts[2m > [22m[2mSkill Loader Module[2m > [22m[2mparseSkillMetadata[2m > [22m[2mshould return null when name is missing
[22m[39mSkipping /tmp/deepagents-skills-test-oCckKX/user-skills/missing-name/SKILL.md: missing required 'name' or 'description'

[90mstderr[2m | src/skills/loader.test.ts[2m > [22m[2mSkill Loader Module[2m > [22m[2mparseSkillMetadata[2m > [22m[2mshould return null when description is missing
[22m[39mSkipping /tmp/deepagents-skills-test-Z4yZtr/user-skills/missing-desc/SKILL.md: missing required 'name' or 'description'

[90mstderr[2m | src/skills/loader.test.ts[2m > [22m[2mSkill Loader Module[2m > [22m[2mparseSkillMetadata[2m > [22m[2mshould truncate long descriptions
[22m[39mDescription exceeds 1024 chars in /tmp/deepagents-skills-test-u6D0uC/user-skills/long-desc/SKILL.md, truncating

[90mstderr[2m | src/skills/loader.test.ts[2m > [22m[2mSkill Loader Module[2m > [22m[2mparseSkillMetadata[2m > [22m[2mshould warn but parse when name doesn't match directory
[22m[39mSkill 'different-name' in /tmp/deepagents-skills-test-0IHCW3/user-skills/my-skill/SKILL.md does not follow Agent Skills spec: name 'different-name' must match directory name 'my-skill'. Consider renaming to be spec-compliant.

[90mstderr[2m | src/skills/loader.test.ts[2m > [22m[2mSkill Loader Module[2m > [22m[2mlistSkills[2m > [22m[2mshould skip skills with invalid frontmatter
[22m[39mSkipping /tmp/deepagents-skills-test-0QD6eW/user-skills/invalid-skill/SKILL.md: no valid YAML frontmatter found

[90mstderr[2m | src/skills/loader.test.ts[2m > [22m[2mSkill Loader Module[2m > [22m[2mlistSkills[2m > [22m[2mshould handle mixed valid and invalid skills
[22m[39mSkipping /tmp/deepagents-skills-test-kOiaWT/user-skills/invalid-one/SKILL.md: missing required 'name' or 'description'

 [32mâœ“[39m src/skills/loader.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 124[2mms[22m[39m
 [32mâœ“[39m src/backends/store.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 379[2mms[22m[39m
     [33m[2mâœ“[22m[39m should handle large tool result interception via middleware [33m 317[2mms[22m[39m
 [32mâœ“[39m src/backends/local-sandbox.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 118[2mms[22m[39m
 [32mâœ“[39m src/backends/state.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 255[2mms[22m[39m
 [32mâœ“[39m src/middleware/agent-memory.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 63[2mms[22m[39m
 [32mâœ“[39m src/config.test.ts [2m([22m[2m26 tests[22m[2m)[22m[32m 50[2mms[22m[39m
 [32mâœ“[39m src/middleware/fs.test.ts [2m([22m[2m28 tests[22m[2m)[22m[32m 90[2mms[22m[39m
 [32mâœ“[39m src/backends/sandbox.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 65[2mms[22m[39m
 [32mâœ“[39m src/middleware/index.test.ts [2m([22m[2m20 tests[22m[2m)[22m[32m 48[2mms[22m[39m
 [32mâœ“[39m src/backends/git.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 31[2mms[22m[39m
 [32mâœ“[39m src/backends/utils.test.ts [2m([22m[2m51 tests[22m[2m)[22m[32m 28[2mms[22m[39m
 [32mâœ“[39m src/middleware/fs.eviction.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 34[2mms[22m[39m
 [32mâœ“[39m src/middleware/utils.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 9[2mms[22m[39m
[90mstderr[2m | src/middleware/summarization.test.ts[2m > [22m[2mcreateSummarizationMiddleware[2m > [22m[2mbackend offloading[2m > [22m[2mshould not proceed with summarization if backend write fails
[22m[39mFailed to offload conversation history to /conversation_history/session_574f765e.md: Write failed

 [32mâœ“[39m src/middleware/summarization.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 19[2mms[22m[39m
 [32mâœ“[39m src/middleware/patch_tool_calls.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m src/backends/protocol.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m src/backends/file-system-access.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 3[2mms[22m[39m
 [32mâœ“[39m [44m[1m TS [22m[49m src/agent.test-d.ts [2m([22m[2m9 tests[22m[2m)[22m

[2m Test Files [22m [1m[32m24 passed[39m[22m[90m (24)[39m
[2m      Tests [22m [1m[32m376 passed[39m[22m[90m (376)[39m
[2mType Errors [22m [2mno errors[22m
[2m   Start at [22m 19:42:57
[2m   Duration [22m 11.35s[2m (transform 2.08s, setup 560ms, import 15.03s, tests 4.23s, environment 6ms, typecheck 2.51s)[22m
